事件冒泡：事件开始由最具体的元素接收，逐级向上传播，一般是直到document对象。

事件捕获：document对象接收事件，事件一直向下传播直到具体目标。

DOM事件流：事件捕获，目标阶段和事件冒泡。

- 事件处理程序，这个函数中存在event这个局部变量，即事件对象。
- event可以直接访问事件对象


动态创建的函数，使用with拓展作用域，目的是让事件处理程序无需引用表单元素就能访问其他表单字段。

```javascript
function () {
    with(document) {
        with(this) {
            // 元素属性值
        }
    }
}
```

html中指定事件处理程序的缺点：
- 时差问题：用户可能在元素一出现在页面上就触发相应的事件，但当时事件处理程序可能不具备执行条件，这样会报错，所以一般会使用一个try-catch封装事件处理程序。
- 这样扩展事件处理程序的作用域链在不同浏览器中会有不同的结果。
- html和javascript代码紧密耦合。

DOM0级事件处理程序：获得一个操作对象，然后`btn.onclick=function()...`
- 这种方式添加的事件处理程序在事件流的冒泡阶段被处理
- 删除：将事件处理程序设置为null

DOM2级事件处理程序：
- addEventListener
- removeEventListener：addEventListener添加的事件处理程序只能这样移除，传入的参数都一样，所以addEventListener添加的匿名函数没办法移除
- 所有DOM节点都有这两个方法
- 三个参数：事件名，事件处理程序的函数，布尔值(true：捕获阶段执行事件处理程序；false：冒泡阶段执行)
- 优点：添加多个事件处理程序
- 推荐在冒泡阶段执行事件处理程序，可以最大限度兼容各种浏览器
- 同一个元素添加多个事件处理程序（同一阶段执行），按照顺序执行相应函数

IE事件处理程序:
- attachEvent()
- detachEvent()
- 两个参数：事件处理程序名称，事件处理函数
- 事件处理程序都会添加到冒泡阶段
- 同一个元素添加多个事件处理程序（同一阶段执行），按照相反的顺序执行相应函数
- 匿名函数不能被移除

**作用域**:
- DOM0级方法：事件处理程序会在其所属元素的作用域内运行
- 使用attachEvent()方法的情况下，事件处理程序会在全局作用域中运行，因此this等于window

跨浏览器的事件处理程序：
- 要保证处理事件的代码能在大多数浏览器下一致低运行，只需要关注冒泡阶段。
- 检测是否存在DOM2级方法，是否存在ie方法，如果不存在，使用DOM0级方法。

---------------------------------------------------------------------------------------------------------

事件对象event：包含着所有与事件相关的信息。

## DOM中的事件对象：

`event.type`:事件类型
`event.`

- 事件处理程序内部，对象this始终等于`currentTarget`（事件处理程序正在处理事件的元素）的值，而`target`（事件的目标）只包含事件的实际目标。
- 如果直接将事件处理程序指定给了目标元素，则this、currentTarget和target包含相同的值
- 如果事件处理程序存在于按钮的父节点中，那么这些值是不相同的

- 阻止特定事件的默认行为，可以使用`preventDefault()`方法。
- 只有`cancelable`(默认行为是否可以取消)为true的事件，才可以使用`preventDefault()`取消默认行为。

- `stopPropagation()`用来立即停止事件在DOM层次中的传播，即取消进一步的事件捕获或冒泡。

事件对象的`eventPhase`，可以用来确定事件当前正位于事件流的哪个阶段。捕获阶段：1；处于目标对象：2；冒泡阶段调用的事件处理程序：3.

> 只有在事件处理程序执行期间，event对象才会存在；一旦执行完成，event对象就会被销毁。
> 事件处理程序的作用域是根据指定它的方式来决定的。

## IE中的事件对象

IE中，访问event对象的方式不同，取决于指定事件处理程序的方法。

- 使用DOM0级方法添加事件处理程序时，event对象作为window的一个属性而存在，`window.event`。
- `attachEvent()`方法：存在一个event对象传入。
- HTML特性指定的事件处理程序，还可以通过event变量来访问。

`srcElement`：事件的目标
`returnValue()`:`preventDefault()`
`cancelBubble()`：`stopPropagation()`，IE不支持事件捕获，所以只能取消事件冒泡。